<!-- open this file in your browser to test the performance of this package -->
<html>
  <body>
    <script src="./chrispolis.hcluster.min.js"></script>
    <script src="../build/hclust.min.js"></script>
    <p>
      <input id="rows" type="number" min="2" max="100000" step="1" value="10" />
      rows
    </p>
    <p>
      <input id="cols" type="number" min="2" max="100000" step="1" value="10" />
      cols
    </p>
    <p>
      <button onclick="runTest('A');">Run Method A</button>
      <button onclick="runTest('B');">Run Method B</button>
    </p>
    <b>Method A (cmpolis/hcluster.js):</b>
    <p id="resultsA"></p>
    <b>Method B (greenelab/hclust):</b>
    <p id="resultsB"></p>
    <script>
      // generate random name for easier identification
      const randomName = () =>
        (Math.random() < 0.5 ? 'a' : 'b') +
        (Math.random() < 0.5 ? 'c' : 'd') +
        (Math.random() < 0.5 ? 'e' : 'f') +
        (Math.random() < 0.5 ? 'g' : 'h') +
        (Math.random() < 0.5 ? 'i' : 'j');

      // generate random integer between 0 and 100
      const randomNumber = () => Math.round(Math.random() * 100);

      // generate random data
      const randomData = (rows, cols) =>
        [...new Array(rows)].map(() => ({
          name: randomName(),
          values: [...new Array(cols)].map(() => randomNumber)
        }));

      // METHOD A - cmpolis/hcluster.js
      const methodA = (data) =>
        hcluster()
          .distance('euclidean')
          .linkage('avg')
          .posKey('values')
          .data(data);

      // METHOD B - greenelab/hclust
      const methodB = (data) =>
        hclust.clusterData({
          data: data,
          key: 'values',
          onProgress: () => null
        });

      // run test on button click
      const runTest = (method) => {
        // results element
        const results = document.getElementById('results' + method);

        // get test parameters from number boxes
        const rows = Number(document.getElementById('rows').value);
        const cols = Number(document.getElementById('cols').value);

        // generate random data to test
        const data = randomData(rows, cols);

        // time a single run of the function
        const start = window.performance.now();
        if (method === 'A')
          methodA(data);
        if (method === 'B')
          methodB(data);
        const end = window.performance.now();
        const time = (end - start).toFixed(2);

        // display results
        results.innerHTML = time + ' ms';
      };
    </script>
  </body>
</html>
